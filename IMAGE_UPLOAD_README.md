# نظام رفع الصور في الفرونت إند

## نظرة عامة

تم إضافة نظام رفع الصور إلى صفحة الدفع في الفرونت إند، مما يسمح للمستخدمين برفع صور للخطط المختارة أثناء عملية الدفع.

## المكونات المضافة

### 1. مكون ImageUpload (`components/ui/image-upload.tsx`)

مكون React قابل لإعادة الاستخدام لرفع الصور مع الميزات التالية:

- **رفع بالسحب والإفلات**: يمكن للمستخدمين سحب الصور وإفلاتها في منطقة الرفع
- **اختيار الملفات**: زر لاختيار الملفات من النظام
- **التحقق من الملفات**: 
  - نوع الملف (صور فقط)
  - حجم الملف (حد أقصى 5MB)
  - عدد الصور (حد أقصى 5 صور)
- **معاينة الصور**: عرض الصور المرفوعة مع إمكانية الحذف
- **واجهة مستخدم تفاعلية**: تأثيرات بصرية عند السحب والإفلات

### 2. تكامل في صفحة الدفع (`app/payment/page.tsx`)

تم إضافة مكون رفع الصور إلى صفحة الدفع مع:

- **عرض الصور في رأس البطاقة**: عرض أول 5 صور مع عداد للصور الإضافية
- **قسم رفع الصور**: قسم مخصص لرفع الصور مع عنوان وصفي
- **ملخص الصور في الشريط الجانبي**: عرض عدد الصور المرفوعة مع معاينة مصغرة

## الاستخدام

### في صفحة الدفع

```tsx
import { ImageUpload } from "@/components/ui/image-upload"

// في المكون
const [planImages, setPlanImages] = useState([])

// في JSX
<ImageUpload
  images={planImages}
  onImagesChange={setPlanImages}
  maxImages={5}
  className="bg-white/5 p-4 rounded-lg"
/>
```

### الخصائص

- `images`: مصفوفة الصور المرفوعة
- `onImagesChange`: دالة تحديث الصور
- `maxImages`: الحد الأقصى لعدد الصور (افتراضي: 5)
- `className`: فئات CSS إضافية

## هيكل البيانات

### UploadedImage Interface

```typescript
interface UploadedImage {
  url: string;           // رابط الصورة
  filename: string;      // اسم الملف في النظام
  originalName: string;  // الاسم الأصلي للملف
  uploadedAt: string;    // تاريخ الرفع
}
```

### PaymentCreateData Interface

تم تحديث واجهة بيانات الدفع لتشمل الصور:

```typescript
interface PaymentCreateData {
  // ... الحقول الموجودة
  planImages?: UploadedImage[];  // الصور المرفوعة للخطة
}
```

## الميزات

### 1. التحقق من الملفات
- **النوع**: صور فقط (PNG, JPG, GIF)
- **الحجم**: حد أقصى 5MB لكل ملف
- **العدد**: حد أقصى 5 صور

### 2. واجهة المستخدم
- **منطقة سحب وإفلات**: مع تأثيرات بصرية
- **معاينة الصور**: عرض الصور المرفوعة
- **حذف الصور**: زر حذف لكل صورة
- **عداد الصور**: عرض عدد الصور المرفوعة

### 3. التكامل
- **عرض في رأس البطاقة**: معاينة سريعة للصور
- **ملخص في الشريط الجانبي**: عرض عدد الصور مع معاينة مصغرة
- **إرسال مع بيانات الدفع**: تضمين الصور في طلب الدفع

## الرسائل والتنبيهات

### رسائل النجاح
- "تم رفع الصور بنجاح"
- "تم حذف الصورة"

### رسائل الخطأ
- "نوع ملف غير صحيح"
- "حجم ملف كبير"
- "حد أقصى للصور"
- "خطأ في رفع الصور"
- "خطأ في حذف الصورة"

## التصميم

### الألوان والأنماط
- **الخلفية**: شفافة مع تأثير blur
- **الحدود**: متقطعة مع تأثيرات hover
- **الأزرار**: ألوان متناسقة مع التصميم العام
- **الرسائل**: ألوان مختلفة حسب النوع (نجاح/خطأ)

### التخطيط
- **شبكة متجاوبة**: عرض الصور في شبكة 2-4 أعمدة
- **معاينة مصغرة**: 20x20 بكسل في رأس البطاقة
- **ملخص جانبي**: 3 صور في صف واحد

## الأمان

### التحقق من الملفات
- التحقق من نوع MIME
- التحقق من حجم الملف
- التحقق من عدد الملفات

### معالجة الأخطاء
- رسائل خطأ واضحة
- معالجة استثناءات الرفع
- معالجة استثناءات الحذف

## التطوير المستقبلي

### ميزات مقترحة
1. **ضغط الصور**: تقليل حجم الصور تلقائياً
2. **تحرير الصور**: تدوير وتغيير حجم الصور
3. **رفع متعدد**: رفع عدة ملفات في نفس الوقت
4. **معاينة أكبر**: عرض الصور بحجم أكبر عند النقر
5. **ترتيب الصور**: إمكانية تغيير ترتيب الصور

### تحسينات الأداء
1. **رفع تدريجي**: رفع الصور في الخلفية
2. **تخزين مؤقت**: تخزين مؤقت للصور المرفوعة
3. **تحسين الصور**: تحسين جودة الصور تلقائياً

## الدعم

للاستفسارات أو المشاكل المتعلقة بنظام رفع الصور، يرجى التواصل مع فريق التطوير. 